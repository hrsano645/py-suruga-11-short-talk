### #民間支援情報ナビ 静岡版を最速で立ち上げた話

#### Unagi.py #27 / Python駿河 #11 オンラインLT大会
### 2020/03/28

---

### お前誰よ

- 佐野浩士 twitter@hrs_sano645
- 普段は自動車金型設計の設計以外何でも屋

- 最近のコミュニティ活動
  - PyCon mini Shizuokaのスタッフしてます
  - オンラインではお世話になりました
  
今日のトークはほぼPython関係ないです。
資料で情報の抜けがあったらすみません。後ほど補足します。
  
---

### PyCon mini Shizuoka オンライン

---

### 新型コロナウイルス/COVID19まだまだこれからっぽい

---

### そんなかで、草の根な活動が結構ありまして

---

### 東京都の新型コロナウイルス対策サイト



---

### この対策サイトができた経緯

---

### バックグラウンドとして

- シビックテックという国や地域の課題を技術で解決するという分野
- アメリカのCode for Americaが立ち上がって、
- そのあと日本でもCode for 系の団体が立ち上がる。
    - Code for Japan（Japanといってもまとめ役とかではない）
    - Code for [色んな地域] :地域で立ち上がってる技術と地域課題を解決する団体。

---

### 対策サイトはかなりはやく動いて作られた

- サイト公開の＊＊ぐらい前にCode for Japan側で動き出す
- 東京都と連携してデータ提供をオープン化する（オープンデータとして提供
- 

---

### 速さはサイトの構造の良さ

- netlifyというGitと親和性高いホスティングサイト
- Javascriptとデータを連携させることで、SPA的にサイトを立ち上げてる
- nuxt.jsとか使ってるそうです

---

### もう一つの関連サイトとして

---

### #民間支援情報ナビ

---

### これは何？

- 新型コロナウイルスに関連して民間から個人や企業支援する話がたすうあがる
- 点在していて探すのが大変
- 総務省/経産省とCode for Japanが取りまとめて
- 

---


### 静岡のシビックテック

いろいろありますし、まだ知らないところ多いけど

- Code for Numazu / Fujinokuni: 沼津メインから静岡全域
- Code for Susono
- Code for Simasho: 島田商業高校の先生が旗振り役
- etc...


---

### 本題

---

### #民間支援情報ナビの静岡版について

---

[#民間支援情報ナビ for 静岡版](https://vs-covid19-shizuoka.netlify.com)

---

### 立ち上げまで

- #民間支援情報ナビがたちあがる。
- ソースコードがgitに公開されていて、見ていたら手軽に動かせそう
- netlifyそういえばつかったことがないから試しにデプロイしてみるか
- ついでに静岡版的なものを作ろうとした時にカスタマイズできるかやってみる

---

### つまり最初は試しに動かしていたサイト

---

### 立ち上げまで（ここから急にはやくなるw

- そのあと、静岡のシビックテック関連の方から声をかけて貰って、
  - 静岡の民間支援をまとめていたけど、このサイト使えます？
- いちおう使えるけど、ちゃんと整えてないから、デプロイ周りを設定し直す
- 開発ルールを一応作って、一般公開
- 静岡のシビックテック団体の方々やNPO法人の方も参加して共同運用を始める

---

### つまりこのサイトは

- お試しで技術的に興味があって試した
- たまたま繋がってた人に声をかけて貰って、本格的に運用を始める
- 
- データやコードの整理をして運用 <- イマココ

---

### なぜできたのか

- サイト自体がインフラをほとんど必要としないつくり
  - Javascript, Googleスプレッドシートを使っている
  - （といっても政府版も一部ユーティリティ的なサーバーを使っていて、今依存しないような仕組みを検討中）
- git開発と親和性が高いサービスを利用
- 継続的CIやGithubを扱ってイテレーションを基にした開発がしやすいかんきょう

---

### 感想

- 日本で行政が絡んでもできる環境が揃ってきたかも
- オープンデータをもとに色んなサービスを考える時の一つの事例として
- 技術で社会貢献はいろいろありますが、こういう方法もあるよーというのを覚えていただければ

---

### おまけ

- いまなやんでる、Googleスプレッドシートからサービスにデータを落とし込むときに
- GoogleスプレッドシートのAPIを使うと利用しすぎて費用請求が出てしまう
- スプレッドシートのWEB公開機能

民間支援情報ナビ 政府版 現在のリビジョンでは、支援情報自体は内部にjsonデータを持って、Googleスプレッドシートから適時コンバートしてるっぽい

---

### Googleスプレッドシートからjson化するために？

- GAS（Google Apps Script）を使ってjson化するスクリプトをつくる
- Google Sheet APIからjson化
- **スプレッドシートのCSV公開情報をDLしてjson化**

---

### Pythonでやろう

---

### 出来ていたら解説

- requests + csv + json の三つのライブラリでやりました

- requestsでGoogleスプレッドシートで公開してるCSVファイルをDL
- csvモジュールでパース -> 1行ずつ辞書でキー名など設定
- jsonモジュールでリスト>辞書構造のデータを変換
