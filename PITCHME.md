### 民間支援情報ナビ 静岡版を最速で立ち上げた話

#### Unagi.py #27 / Python駿河 #11 オンラインLT大会 2020/03/28 
#### Hiroshi Sano

---

### お前誰よ

- 佐野浩士 twitter@hrs_sano645
- 普段は自動車金型設計の設計以外の全部担当

- 最近のコミュニティ活動
  - PyCon mini Shizuokaのスタッフしてます
  - オンライン開催ではお世話になりました
- 無人島暮らし始めました


今日のトークはほぼPython関係ないです。
  
---

資料で情報の抜けがあったらすみません。後ほど補足します。

---

### PyCon mini Shizuoka オンラインお疲れさまでした🙇‍♂️
---

### 新型コロナウイルス/COVID19まだまだこれからっぽい

---

### そんなかで、草の根な活動が結構ありまして

---

### 東京都の新型コロナウイルス対策サイト

[東京都 新型コロナウイルス感染症対策サイト](https://stopcovid19.metro.tokyo.lg.jp/about/)

[tokyo-metropolitan-gov/covid19](https://github.com/tokyo-metropolitan-gov/covid19)

---

### この対策サイトができた経緯

---

### バックグラウンドとして

- シビックテックという国や地域の課題を技術で解決するという分野
- アメリカのCode for Americaが立ち上がって、
- そのあと日本でもCode for 系の団体が立ち上がる。
    - Code for Japan（Japanといってもまとめ役とかではない）
    - Code for [色んな地域] :地域で立ち上がってる技術と地域課題を解決する団体。

---

### 対策サイトはかなりはやく動いて作られた

- 3/4のサイト公開の5日前（2/29）ぐらい前にCode for Japan側で動き出す
- 東京都と連携してデータ提供をオープン化する（オープンデータとして提供
- その後関心が集まり、Code for JapanのSlackチャンネルに多数の参加者も集まる

---

### 速さはサイトの構造の良さ

- netlifyというGitと親和性高いホスティングサイト
- Javascriptとデータを連携させることで、SPA的にサイトを立ち上げてる
- typescript + nuxt.jsを使ってるそうです

---

### もう一つの関連サイトとして



---

### [VS COVID-19 #民間支援情報ナビ](https://vscovid19.code4japan.org/)

---

### これは何？

- 新型コロナウイルスに関連して民間から個人や企業支援する話がたすうあがる
- 点在していて探すのが大変
- 総務省/経産省とCode for Japanが取りまとめて公開
- サイトはオープンソース、データはオープンデータ

github:[codeforjapan/vs-covid19:](https://github.com/codeforjapan/vs-covid19)

---

### 本題

---

### #民間支援情報ナビ 静岡版を作ったよ

---

### [#民間支援情報ナビ for 静岡版](https://vs-covid19-shizuoka.netlify.com)

github: [hrsano645/vs-covid19](https://github.com/hrsano645/vs-covid19)

---

### 立ち上げまで

- 3/9
  - #民間支援情報ナビがたちあがる。
- 3/10
  - ソースコードがgitに公開されていて、見ていたら手軽に動かせそう
  - netlifyそういえばつかったことがないから試しにデプロイしてみた
  - 試しに静岡版的なものを作ろうとした時にカスタマイズできるかやってみる

---

### つまり最初は試しに動かしていたサイト

https://twitter.com/hrs_sano645/status/1237338261455949824

https://twitter.com/hrs_sano645/status/1237347051458850816

---

### 立ち上げまで（ここから急展開w

- 3/10
  - 静岡のシビックテック関連の方から声をかけて貰って、
    - 静岡の民間支援をまとめていたけど、このサイト使えます？
  - ちゃんと整えてないから、デプロイ周りを設定し直す
  - 開発ルールを用意して、一般公開
- 3/12
  - 静岡のシビックテック団体の方々やNPO法人の方も参加して共同運用を始める

---

### 立ち上げまでをまとめると

- お試しで技術的に興味があって試した
- たまたま繋がってた人に声をかけて貰って、本格的に運用を始める
- データやコードの整理をして運用 <- イマココ

---

### なぜできたのか

- サイト自体がインフラをほとんど必要としないつくり
  - Javascript, Googleスプレッドシートを使っている
  - （といっても政府版も一部ユーティリティ的なサーバーを使っていて、今依存しないような仕組みを検討中）
- git開発と親和性が高いサービスを利用
- 継続的CIやGitHubを扱ってイテレーションを基にした開発
- 静岡にもシビックテック関係の方、団体がいます

---


### 静岡のシビックテック

いろいろありますがCode forで掻い摘むと

- Code for Numazu / ふじのくに
- Code for Susono
- Code for kakegawa
- Code for Simasho
- etc...

---

### 感想

- 日本で行政が絡んでもできる環境が揃ってきたかも
- オープンデータをもとに色んなサービスを考える時の1つの事例として
- 技術で社会貢献はいろいろありますが、こういう方法もあるよーというのを覚えていただければ

---

### おまけ:悩み事を今解決する

- Googleスプレッドシートからサービスにデータを入れるとき
  - GoogleスプレッドシートのAPIを使うと利用しすぎて費用請求が出てしまう
  - スプレッドシートのWEB公開機能

民間支援情報ナビ 政府版 現在のリビジョンでは、支援情報自体は内部にjsonデータを持って、Googleスプレッドシートから適時コンバートしてる

---

### Googleスプレッドシートからjson化するために？

- GAS（Google Apps Script）を使ってjson化するスクリプトをつくる
- Google Sheet APIからjson化
- **スプレッドシートのCSV公開情報をDLしてjson化**

---

### Pythonでやろう

---

### 出来ていたら解説、できていなければ懇親会中にやってますｗ

---

### Pythonでの方法論

- requests + csv + json の三つのライブラリでやりました
- requestsでGoogleスプレッドシートで公開してるCSVファイルをDL
- csvモジュールでパース -> 1行ずつ辞書でキー名など設定
- jsonモジュールでリスト>辞書構造のデータを変換
